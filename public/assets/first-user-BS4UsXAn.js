import{q as Z,r as t,j as e,t as c,T as x,I as v,v as E,w as W,x as O,L as q}from"./index-CguHGk5K.js";import{C as N}from"./config-global-C1bjA4IF.js";import{T as P}from"./TextField-BHvFdFV8.js";function K(){const y=Z(),[d,M]=t.useState(""),[m,R]=t.useState(""),[f,T]=t.useState(!1),[h,F]=t.useState(!1),[l,B]=t.useState(""),[u,L]=t.useState(""),[a,S]=t.useState({}),[n,k]=t.useState({}),[i,A]=t.useState(!1),z=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,I=t.useCallback(()=>{const s={};return d.trim()?d.length<3&&(s.username="Username must be at least 3 characters"):s.username="Username is required",m.trim()?z.test(m)||(s.email="Please enter a valid email address"):s.email="Email is required",l?l.length<8?s.password="Password must be at least 8 characters":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(l)||(s.password="Password must contain uppercase, lowercase, and numbers"):s.password="Password is required",u?u!==l&&(s.confirmPassword="Passwords do not match"):s.confirmPassword="Please confirm your password",S(s),s},[d,m,l,u]),p=t.useCallback((s,o)=>{const r={...a};switch(s){case"username":o.trim()?o.length<3?r.username="Username must be at least 3 characters":delete r.username:r.username="Username is required";break;case"email":o.trim()?z.test(o)?delete r.email:r.email="Please enter a valid email address":r.email="Email is required";break;case"password":o?o.length<8?r.password="Password must be at least 8 characters":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(o)?delete r.password:r.password="Password must contain uppercase, lowercase, and numbers":r.password="Password is required";break;case"confirmPassword":o?o!==l?r.confirmPassword="Passwords do not match":delete r.confirmPassword:r.confirmPassword="Please confirm your password";break}S(r)},[a,l]),j=t.useCallback(async()=>{k({username:!0,email:!0,password:!0,confirmPassword:!0});const o=I();if(!(Object.keys(o).length>0)){A(!0);try{console.log("Account created:",{username:d,email:m,password:l}),await new Promise(C=>setTimeout(C,1e3)),y.push("/")}catch(C){console.error("Submission failed:",C),S(U=>({...U,submit:"Failed to create account. Please try again."}))}finally{A(!1)}}},[d,m,l,y,I]),w=t.useCallback(s=>{s.key==="Enter"&&!i&&j()},[j,i]),b=t.useCallback(s=>o=>{const r=o.target.value;switch(s){case"username":M(r);break;case"email":R(r);break;case"password":B(r);break;case"confirmPassword":L(r);break}n[s]&&p(s,r)},[n,p]),g=t.useCallback(s=>()=>{k(o=>({...o,[s]:!0})),p(s,s==="username"?d:s==="email"?m:s==="password"?l:u)},[d,m,l,u,p]);return e.jsx(c,{sx:{position:"fixed",inset:0,display:"flex",alignItems:"flex-start",justifyContent:"center",bgcolor:"#f4f6f8",px:{xs:2,sm:0},pt:{xs:2,sm:3},pb:{xs:1,sm:4},height:"100vh",overflow:"hidden"},children:e.jsxs(c,{sx:{bgcolor:"#fff",p:{xs:3,sm:5},borderRadius:{xs:2,sm:3},boxShadow:"0 4px 16px rgba(0,0,0,0.08)",width:"100%",maxWidth:{xs:"calc(100vw - 32px)",sm:420},mx:"auto",mt:{xs:0,sm:2},maxHeight:{xs:"calc(100vh - 32px)",sm:"auto"},overflow:"hidden"},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:{xs:3,sm:4}},children:[e.jsx(c,{component:"img",src:"/assets/images/school-logo.png",alt:"School Logo",sx:{width:{xs:60,sm:75},height:"auto",mr:{xs:1,sm:1.5}}}),e.jsxs(c,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"left",lineHeight:1.2},children:[e.jsx(x,{variant:"caption",sx:{color:"text.secondary",fontWeight:500,letterSpacing:.4,fontSize:{xs:10,sm:11}},children:"TaparSoft"}),e.jsx(x,{variant:"h6",sx:{fontWeight:700,fontSize:{xs:"1.1rem",sm:"1.25rem"}},children:"SchoolMANAGER"}),e.jsx(x,{variant:"subtitle2",sx:{fontWeight:600,color:"text.secondary",fontSize:{xs:9,sm:10},textAlign:"right",letterSpacing:.3,whiteSpace:"nowrap"},children:"School Management System"})]})]}),e.jsx(x,{variant:"h5",sx:{mb:{xs:2.5,sm:3.5},fontWeight:600,textAlign:"center",color:"text.primary",fontSize:{xs:"1rem",sm:"1.1rem"}},children:"Set new password and email address"}),e.jsxs(c,{sx:{display:"flex",flexDirection:"column",gap:{xs:2,sm:2.5}},children:[e.jsx(P,{fullWidth:!0,label:n.username&&a.username?a.username:"Username",value:d,onChange:b("username"),onBlur:g("username"),onKeyPress:w,error:n.username&&!!a.username,disabled:i,sx:{"& .MuiOutlinedInput-root":{borderRadius:1.2,fontSize:{xs:"0.9rem",sm:"1rem"}},"& .MuiInputLabel-root":{color:n.username&&a.username?"error.main":"text.secondary"}}}),e.jsx(P,{fullWidth:!0,label:n.email&&a.email?a.email:"Email Address",type:"email",value:m,onChange:b("email"),onBlur:g("email"),onKeyPress:w,error:n.email&&!!a.email,disabled:i,sx:{"& .MuiOutlinedInput-root":{borderRadius:1.2,fontSize:{xs:"0.9rem",sm:"1rem"}},"& .MuiInputLabel-root":{color:n.email&&a.email?"error.main":"text.secondary"}}}),e.jsx(P,{fullWidth:!0,label:n.password&&a.password?a.password:"Password",type:f?"text":"password",value:l,onChange:b("password"),onBlur:g("password"),onKeyPress:w,error:n.password&&!!a.password,disabled:i,sx:{"& .MuiOutlinedInput-root":{borderRadius:1.2,fontSize:{xs:"0.9rem",sm:"1rem"}},"& .MuiInputLabel-root":{color:n.password&&a.password?"error.main":"text.secondary"}},InputProps:{endAdornment:e.jsx(v,{position:"end",children:e.jsx(E,{onClick:()=>T(!f),size:"small",edge:"end","aria-label":f?"Hide password":"Show password",disabled:i,children:e.jsx(W,{icon:f?"solar:eye-bold":"solar:eye-closed-bold",width:20})})})}}),e.jsx(P,{fullWidth:!0,label:n.confirmPassword&&a.confirmPassword?a.confirmPassword:"Confirm Password",type:h?"text":"password",value:u,onChange:b("confirmPassword"),onBlur:g("confirmPassword"),onKeyPress:w,error:n.confirmPassword&&!!a.confirmPassword,disabled:i,sx:{"& .MuiOutlinedInput-root":{borderRadius:1.2,fontSize:{xs:"0.9rem",sm:"1rem"}},"& .MuiInputLabel-root":{color:n.confirmPassword&&a.confirmPassword?"error.main":"text.secondary"}},InputProps:{endAdornment:e.jsx(v,{position:"end",children:e.jsx(E,{onClick:()=>F(!h),size:"small",edge:"end","aria-label":h?"Hide password":"Show password",disabled:i,children:e.jsx(W,{icon:h?"solar:eye-bold":"solar:eye-closed-bold",width:20})})})}}),a.submit&&e.jsx(x,{color:"error",variant:"caption",sx:{display:"block",textAlign:"center",mt:1,fontSize:{xs:"0.75rem",sm:"0.8rem"},fontWeight:500},children:a.submit}),e.jsx(O,{fullWidth:!0,variant:"contained",size:"large",disabled:i,sx:{mt:{xs:1.2,sm:1.8},py:{xs:1.1,sm:1.4},fontWeight:600,borderRadius:1.8,textTransform:"none",boxShadow:"none",fontSize:{xs:"0.92rem",sm:"1rem"},"&:hover":{boxShadow:i?"none":"0 4px 12px rgba(0,0,0,0.15)"},"&.Mui-disabled":{backgroundColor:"action.disabledBackground",color:"action.disabled"}},onClick:j,children:i?"CREATING ACCOUNT...":"CONFIRM"}),e.jsx(c,{sx:{textAlign:"center",mt:{xs:1.3,sm:1.8}},children:e.jsx(q,{variant:"body2",color:"text.secondary",sx:{cursor:"pointer",fontWeight:500,fontSize:{xs:"0.82rem",sm:"0.875rem"},"&:hover":{color:"primary.main"},...i&&{pointerEvents:"none",opacity:.5}},onClick:()=>!i&&y.push("/login"),children:"Back to Login"})})]})]})})}function D(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:`First User - ${N.appName}`}),e.jsx(K,{})]})}export{D as default};
