import{q as k,r as t,j as e,t as l,T as m,x as C,L as T}from"./index-CguHGk5K.js";import{C as R}from"./config-global-C1bjA4IF.js";import{T as E}from"./TextField-BHvFdFV8.js";function W(){const u=k(),[r,y]=t.useState(""),[n,d]=t.useState({}),[c,g]=t.useState({}),[o,p]=t.useState(!1),b=t.useCallback(()=>{const s={};return r.trim()?r.trim().length<3&&(s.username="Username must be at least 3 characters long"):s.username="Username is required",d(s),s},[r]),x=t.useCallback((s,a)=>{const i={...n};switch(s){case"username":a.trim()?a.trim().length<3?i.username="Username must be at least 3 characters long":delete i.username:i.username="Username is required";break}d(i)},[n]),h=t.useCallback(async()=>{g({username:!0});const a=b();if(!(Object.keys(a).length>0)){p(!0);try{console.log("Reset link requested for username:",r),await new Promise(f=>setTimeout(f,1e3)),u.push("/reset-password-confirmation")}catch(f){console.error("Reset request failed:",f),d(w=>({...w,submit:"Failed to send reset link. Please try again."}))}finally{p(!1)}}},[r,u,b]),S=t.useCallback(s=>{s.key==="Enter"&&!o&&h()},[h,o]),j=t.useCallback(s=>a=>{const i=a.target.value;y(i),c[s]&&x(s,i)},[c,x]),v=t.useCallback(s=>()=>{g(a=>({...a,[s]:!0})),x(s,r)},[r,x]);return e.jsx(l,{sx:{position:"fixed",inset:0,display:"flex",alignItems:"flex-start",justifyContent:"center",bgcolor:"#f4f6f8",px:{xs:1,sm:0},pt:{xs:5,sm:4},pb:{xs:1,sm:4},height:"100vh",overflow:"hidden"},children:e.jsxs(l,{sx:{bgcolor:"#fff",p:{xs:3,sm:5},borderRadius:{xs:2,sm:3},boxShadow:"0 4px 16px rgba(0,0,0,0.08)",width:"100%",maxWidth:{xs:"calc(100vw - 32px)",sm:420},mx:"auto",mt:{xs:0,sm:2},maxHeight:{xs:"calc(100vh - 32px)",sm:"auto"},overflow:"hidden"},children:[e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",mb:{xs:3,sm:4}},children:[e.jsx(l,{component:"img",src:"/assets/images/school-logo.png",alt:"School Logo",sx:{width:{xs:60,sm:75},height:"auto",mr:{xs:1,sm:1.5}}}),e.jsxs(l,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",textAlign:"left",lineHeight:1.2},children:[e.jsx(m,{variant:"caption",sx:{color:"text.secondary",fontWeight:500,letterSpacing:.4,fontSize:{xs:10,sm:11}},children:"TaparSoft"}),e.jsx(m,{variant:"h6",sx:{fontWeight:700,fontSize:{xs:"1.1rem",sm:"1.25rem"}},children:"SchoolMANAGER"}),e.jsx(m,{variant:"subtitle2",sx:{fontWeight:600,color:"text.secondary",fontSize:{xs:9,sm:10},textAlign:"right",letterSpacing:.3,whiteSpace:"nowrap"},children:"School Management System"})]})]}),e.jsx(m,{variant:"h5",sx:{mb:{xs:2.5,sm:3.5},fontWeight:600,textAlign:"center",color:"text.primary",fontSize:{xs:"1rem",sm:"1.1rem"}},children:"Account reset password request from school"}),e.jsxs(l,{sx:{display:"flex",flexDirection:"column",gap:{xs:1.5,sm:2}},children:[e.jsx(E,{fullWidth:!0,label:c.username&&n.username?n.username:"Username",type:"text",value:r,onChange:j("username"),onBlur:v("username"),onKeyPress:S,error:c.username&&!!n.username,disabled:o,sx:{"& .MuiOutlinedInput-root":{borderRadius:1.2,fontSize:{xs:"0.9rem",sm:"1rem"}},"& .MuiInputLabel-root":{color:c.username&&n.username?"error.main":"text.secondary"}}}),n.submit&&e.jsx(m,{color:"error",variant:"caption",sx:{display:"block",textAlign:"center",mt:1,fontSize:{xs:"0.75rem",sm:"0.8rem"},fontWeight:500},children:n.submit}),e.jsx(C,{fullWidth:!0,variant:"contained",size:"large",disabled:o,sx:{mt:{xs:1.2,sm:1.8},py:{xs:1.1,sm:1.4},fontWeight:600,borderRadius:1.8,textTransform:"none",boxShadow:"none",fontSize:{xs:"0.92rem",sm:"1rem"},"&:hover":{boxShadow:o?"none":"0 4px 12px rgba(0,0,0,0.15)"},"&.Mui-disabled":{backgroundColor:"action.disabledBackground",color:"action.disabled"}},onClick:h,children:o?"SUBMITTING...":"SUBMIT"}),e.jsx(l,{sx:{textAlign:"center",mt:{xs:1.3,sm:1.8}},children:e.jsx(T,{variant:"body2",color:"text.secondary",sx:{cursor:"pointer",fontWeight:500,fontSize:{xs:"0.82rem",sm:"0.875rem"},"&:hover":{color:"primary.main"},...o&&{pointerEvents:"none",opacity:.5}},onClick:()=>!o&&u.push("/login"),children:"Back to Login"})})]})]})})}function q(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:`Reset Password - ${R.appName}`}),e.jsx(W,{})]})}export{q as default};
